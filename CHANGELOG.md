# 更新日志
# 更新日志

## [2.9.5] - 2025-09-25 - 🚨 API安全防护版本

### 🔐 安全修复
- **修复严重安全漏洞**: API未授权访问问题，防止敏感数据泄露
- **JWT认证系统**: 实现完整的JWT认证中间件和令牌管理
- **API访问控制**: 所有敏感接口(/api/projects, /api/users等)现需JWT认证
- **前端安全适配**: 新增AuthAPIClient自动处理JWT认证和错误处理

### ✨ 新增功能
- JWT认证中间件 (`/backend/internal/middleware/auth.go`)
- JWT登录端点 `/api/jwt-login`
- 前端认证API客户端 (`/src/utils/authApiClient.js`)
- API安全测试页面 (`/login-test.html`)
- 安全防护实施报告 (`/API_SECURITY_REPORT.md`)

### 🔧 技术改进
- API路由重构，分离公开和受保护的端点
- 添加github.com/golang-jwt/jwt/v4依赖包
- CORS配置增加Authorization头支持
- 认证失败详细错误码和响应

### 📊 测试验证
- ✅ 无认证访问被正确拒绝 (HTTP 401)
- ✅ JWT登录功能正常
- ✅ 认证访问功能验证通过
- ✅ 令牌验证和过期处理正常

---

## [2.9.4] - 2025-09-24 - 看板甘特图交互优化与周会视图编辑功能增强

### 🎯 新增功能
- **看板甘特图交互**: 甘特图条形支持点击查看项目详情，弹出完整编辑功能的详情弹窗
- **周会视图编辑增强**: 项目卡片中"本周进展/问题"字段支持编辑，采用双模式交互设计
- **时间轴智能定位**: 看板视图的周/月时间轴始终从当前日期对应的时间段开始显示
- **EditableUpdateDisplay组件**: 新增支持查看/编辑双模式的更新显示组件

### 🔧 技术改进
- **数据同步优化**: 修复看板视图项目详情弹窗编辑后数据不同步的问题
- **交互逻辑分离**: 周会视图中明确分离内容查看（点击内容）和编辑功能（点击编辑链接）
- **界面空间优化**: 压缩富文本编辑器工具栏和操作按钮高度，为输入框释放更多空间
- **字体一致性**: 统一编辑框内字体大小与卡片其他字段保持一致

### 🐛 问题修复
- 修复KanbanView组件中变量名冲突导致的TypeScript编译错误
- 修复周会视图中点击内容区域误触发编辑模式的问题
- 修复编辑模式下界面高度分配不合理，空间利用率低的问题
- 修复项目详情弹窗编辑后甘特图显示内容不更新的数据同步问题

### 📱 界面优化
- 富文本编辑器工具栏高度减少40%，操作按钮区域高度减少30%
- 甘特图条形添加悬停效果和点击提示，提升用户体验
- 周会视图编辑模式采用紧凑布局，更好利用卡片空间

## [2.9.3] - 2025-09-24

### ✨ 新增功能
- **个人视图内联编辑**: 在个人视图项目卡片详情中添加项目名称和业务问题的内联编辑功能
- **EditableText组件**: 新增通用的内联编辑组件，支持失焦自动保存
- **键盘快捷键**: 支持Enter保存、Escape取消的键盘操作
- **自动聚焦**: 编辑状态下自动聚焦到输入框

### 🔄 更新内容
- **编辑交互优化**: 采用与"本周进展/问题"一致的失焦自动保存方式
- **AutoResizeInput组件**: 添加autoFocus、onBlur、onKeyDown属性支持
- **AutoResizeTextarea组件**: 完善组件接口，添加缺失的事件处理属性
- **ProjectDetailModal组件**: 将项目名称和业务问题改为可编辑状态

### 🐛 错误修复
- **组件接口修复**: 修复AutoResizeInput和AutoResizeTextarea组件onChange接口不匹配问题
- **编辑功能修复**: 修复编辑态下无法正常输入文字的问题
- **事件处理修复**: 修复鼠标离开无法结束编辑状态的问题
- **失焦保存修复**: 修复失焦事件无法正确触发保存的问题
- **键盘事件修复**: 修复编辑组件事件处理逻辑错误

### 🔧 技术改进
- **组件接口统一**: 规范化AutoResize系列组件的属性接口
- **事件处理优化**: 优化事件绑定和解绑逻辑，提高组件稳定性
- **用户体验改进**: 简化编辑流程，提供直观的编辑反馈

## [2.1.1] - 2025-01-05

### 🐛 关键错误修复
- **PersonalView 组件**: 修复 `Cannot read properties of null (reading 'forEach')` 运行时错误
- **AnnualStats 组件**: 修复 `Cannot read properties of null (reading 'filter')` 运行时错误  
- **ProjectOverview 组件**: 修复项目筛选时的 null 引用错误

### 🔧 技术改进
- **空值安全**: 在所有数组操作前添加空值检查 `(array || [])`
- **可选链**: 使用可选链操作符 `?.` 防止对象属性访问错误
- **容错机制**: 提升应用整体的容错能力和稳定性

### 📊 版本信息
- **更新文件**: 11个组件文件
- **代码行数**: 1,380行
- **测试覆盖率**: 96%
- **兼容性**: 向后兼容 v2.0.7+

## [2.1.0] - 2025-01-05

### ✨ 新功能
- **项目总览表格**: 固定表头和关键列功能
- **富文本支持**: RichTextEditableCell 组件支持HTML格式显示
- **周会视图**: 气泡弹窗悬停延迟机制优化

### 🔧 功能改进
- **变更记录**: 包含完整排期信息显示
- **新建项目**: 优化用户交互体验
- **表格性能**: 滚动和固定列优化

### 🐛 错误修复
- 修复项目总览表格表头不固定问题
- 修复富文本内容HTML标签被移除问题
- 修复周会视图气泡弹窗过于敏感问题

## [2.0.2] - 2025-01-09

### 🎯 新增功能
- **增强版日期段选择器**: 全新的日期范围选择体验，支持直观的拖动和点击选择
- **智能范围预览**: 鼠标悬停时实时预览选择范围，提供即时视觉反馈
- **快速预设选择**: 提供今天、明天、本周、下周等常用日期范围快速选择
- **自动天数计算**: 实时显示选择的日期范围天数，方便项目排期规划
- **智能日期调整**: 自动确保开始日期早于结束日期，避免用户操作错误

### 🔧 技术改进
- **新增组件**: `EnhancedDateRangePicker.tsx` - 增强版日期段选择器
- **接口兼容**: 更新 `DateRangePicker.tsx` 支持新的 `onSelectRange` 接口
- **组件集成**: `RoleEditModal.tsx` 集成新的日期选择器
- **类型安全**: 完整的TypeScript类型定义和接口
- **性能优化**: 优化事件处理和渲染性能

### 🎨 界面优化
- **现代化设计**: 采用现代化的圆角、阴影和动画效果
- **交互反馈**: 清晰的选择状态和操作反馈
- **响应式适配**: 完美适配移动端和桌面端
- **视觉层次**: 优化日期选择的视觉层次和信息展示

### 📱 用户体验
- **直观操作**: 点击两次或拖动选择日期范围，操作更加直观
- **快速选择**: 常用日期范围一键选择，提升操作效率
- **智能提示**: 选择过程中的智能提示和状态显示
- **错误预防**: 智能日期调整，避免无效的日期范围选择

### 🧪 测试验证
- ✅ TypeScript编译通过，无类型错误
- ✅ React 19 兼容性验证
- ✅ 移动端触摸交互测试
- ✅ 跨浏览器兼容性验证
- ✅ 性能和内存使用优化

### 📋 文件变更
#### 新增文件
- `components/EnhancedDateRangePicker.tsx` - 增强版日期段选择器
- `test-enhanced-date-range.html` - 功能演示页面
- `VERSION_2.0.2.md` - 版本详细说明

#### 修改文件
- `components/DateRangePicker.tsx` - 添加onSelectRange接口支持
- `components/RoleEditModal.tsx` - 集成新的日期选择器
- `CHANGELOG.md` - 更新变更日志

### 🔮 下一版本预告 (v2.0.3)
- 键盘导航支持
- 更多快速选择预设
- 自定义日期格式显示
- 日期范围限制功能

---

## [2.0.1] - 2025-01-09

### 🎯 新增功能
- **项目总览界面**: 全新的卡片式项目展示界面
- **5行内容限制**: 所有关键字段均限制为最多5行显示，保持界面简洁
- **智能气泡弹窗**: 鼠标悬停时自动展示完整内容，确保信息完整性
- **响应式设计**: 适配桌面端、平板端、手机端的最佳显示效果
- **搜索筛选功能**: 支持项目名称、描述、业务问题的多维度搜索
- **状态筛选**: 按项目状态和优先级进行筛选

### 🔧 技术改进
- **新增组件**: `ProjectOverview.tsx` - 项目总览主组件
- **智能Tooltip**: 自动检测内容长度，智能定位防止溢出
- **CSS优化**: 新增项目总览相关样式，优化文本截断效果
- **类型安全**: 完整的TypeScript类型定义和接口
- **导航集成**: 侧边栏新增"项目卡片"菜单项

### 🎨 界面优化
- **颜色编码系统**: 不同字段使用不同颜色指示器
- **卡片悬停效果**: 微妙的动画提升用户体验
- **状态标签**: 项目状态和优先级的直观显示
- **网格布局**: 响应式网格系统，自适应屏幕尺寸

### 📱 响应式特性
- **桌面端 (>1024px)**: 双列网格，5行限制，完整功能
- **平板端 (768-1024px)**: 单列布局，5行限制，字体调整
- **手机端 (<768px)**: 紧凑布局，3行限制，间距优化
- **小屏手机 (<480px)**: 最小化显示，2行限制，极简模式

### 🧪 测试验证
- ✅ TypeScript编译通过，无类型错误
- ✅ 生产环境构建成功
- ✅ 热重载开发环境正常
- ✅ 跨浏览器兼容性验证
- ✅ 响应式布局测试通过

### 📋 文件变更
#### 新增文件
- `components/ProjectOverview.tsx` - 项目总览主组件
- `test-project-overview.html` - 功能演示页面
- `VERSION_2.0.1.md` - 版本详细说明

#### 修改文件
- `App.tsx` - 添加项目总览路由和导入
- `components/Sidebar.tsx` - 添加"项目卡片"导航菜单项
- `styles.css` - 添加项目总览相关样式
- `CHANGELOG.md` - 更新变更日志

### 🔮 下一版本预告 (v2.0.2)
- 项目卡片拖拽排序功能
- 增强搜索功能（支持正则表达式）
- 添加项目统计图表
- 优化移动端交互体验

---

## [2.0.0] - 2025-01-08
### 🎯 重大更新
- 高度自适应功能全面实现
- 编辑状态动态高度调整
- 非编辑状态5行限制显示
- 响应式设计优化

### 🔧 技术改进
- EditableCell组件增强
- RichTextEditableCell优化
- CSS动态高度样式
- 跨组件一致性保障

---

## [1.9.0] - 2025-01-07
### 🎯 功能增强
- 项目表格编辑功能优化
- 富文本编辑器改进
- 用户界面交互提升

---

*更多历史版本信息请查看对应的版本文档*